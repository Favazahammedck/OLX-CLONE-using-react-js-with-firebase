{"ast":null,"code":"'use strict';\n\nmodule.exports.init = function (nameSpace) {\n  return function (req, res, next) {\n    if (req.user && nameSpace) {\n      var groups = nameSpace + '/groups';\n      var roles = nameSpace + '/roles';\n      var permissions = nameSpace + '/permissions';\n      if (req.user[groups]) req.groups = req.user[groups];\n      if (req.user[roles]) req.roles = req.user[roles];\n      if (req.user[permissions]) req.permissions = req.user[permissions];\n    }\n\n    next();\n  };\n};\n\nmodule.exports.group = function (groupsAllowed) {\n  return function (req, res, next) {\n    var groups = req.groups;\n    if (!groups) return res.status(401).send(\"Not authorized, group empty\");\n    if (!groupsAllowed) return next();\n\n    if (Array.isArray(groupsAllowed)) {\n      var found = groups.some(function (r) {\n        return groupsAllowed.includes(r);\n      });\n      if (!found) return res.status(401).send(\"Group missing\");\n    } else if (typeof groupsAllowed === 'string' || groupsAllowed instanceof String) {\n      if (groups.indexOf(groupsAllowed) === -1) return res.status(401).send(\"Group missing\");\n    }\n\n    return next();\n  };\n};\n\nmodule.exports.role = function (rolesAllowed) {\n  return function (req, res, next) {\n    var roles = req.roles;\n    if (!roles) return res.status(401).send(\"Not authorized, roles empty\");\n    if (!rolesAllowed) return next();\n\n    if (Array.isArray(rolesAllowed)) {\n      var found = roles.some(function (r) {\n        return rolesAllowed.includes(r);\n      });\n      if (!found) return res.status(401).send(\"Role missing\");\n    } else if (typeof rolesAllowed === 'string' || rolesAllowed instanceof String) {\n      if (roles.indexOf(rolesAllowed) === -1) return res.status(401).send(\"Role missing\");\n    }\n\n    return next();\n  };\n};\n\nmodule.exports.permission = function (permissionsAllowed) {\n  return function (req, res, next) {\n    var permissions = req.permissions;\n    if (!permissions) return res.status(401).send(\"Not authorized, permissions empty\" + permissions);\n    if (!permissionsAllowed) return next();\n\n    if (Array.isArray(permissionsAllowed)) {\n      var found = permissions.some(function (r) {\n        return permissionsAllowed.includes(r);\n      });\n      if (!found) return res.status(401).send(\"Permission missing\");\n    } else if (typeof permissionsAllowed === 'string' || permissionsAllowed instanceof String) {\n      if (permissions.indexOf(permissionsAllowed) === -1) return res.status(401).send(\"Permission missing\");\n    }\n\n    return next();\n  };\n};","map":{"version":3,"sources":["/Users/arif/Desktop/React/untitled folder/React_tutorial_olx_clone/node_modules/require-auth/index.js"],"names":["module","exports","init","nameSpace","req","res","next","user","groups","roles","permissions","group","groupsAllowed","status","send","Array","isArray","found","some","r","includes","String","indexOf","role","rolesAllowed","permission","permissionsAllowed"],"mappings":"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","sourcesContent":["'use strict';\n\nmodule.exports.init = function (nameSpace) {\n  return function (req, res, next) {\n    if (req.user && nameSpace) {\n      var groups = nameSpace + '/groups';\n      var roles = nameSpace + '/roles';\n      var permissions = nameSpace + '/permissions';\n      if (req.user[groups]) req.groups = req.user[groups];\n      if (req.user[roles]) req.roles = req.user[roles];\n      if (req.user[permissions]) req.permissions = req.user[permissions];\n    }\n    next();\n  };\n};\n\nmodule.exports.group = function (groupsAllowed) {\n  return function (req, res, next) {\n    var groups = req.groups;\n    if (!groups) return res.status(401).send(\"Not authorized, group empty\");\n    if (!groupsAllowed) return next();\n\n    if (Array.isArray(groupsAllowed)) {\n      var found = groups.some(function (r) {\n        return groupsAllowed.includes(r);\n      });\n      if (!found) return res.status(401).send(\"Group missing\");\n    }\n    else if (typeof groupsAllowed === 'string' || groupsAllowed instanceof String) {\n      if (groups.indexOf(groupsAllowed) === -1) return res.status(401).send(\"Group missing\");\n    }\n\n    return next();\n  };\n};\nmodule.exports.role = function (rolesAllowed) {\n  return function (req, res, next) {\n    var roles = req.roles;\n    if (!roles) return res.status(401).send(\"Not authorized, roles empty\");\n    if (!rolesAllowed) return next();\n\n    if (Array.isArray(rolesAllowed)) {\n      var found = roles.some(function (r) {\n        return rolesAllowed.includes(r);\n      });\n      if (!found) return res.status(401).send(\"Role missing\");\n    }\n    else if (typeof rolesAllowed === 'string' || rolesAllowed instanceof String) {\n      if (roles.indexOf(rolesAllowed) === -1) return res.status(401).send(\"Role missing\");\n    }\n\n    return next();\n  };\n};\n\nmodule.exports.permission = function (permissionsAllowed) {\n  return function (req, res, next) {\n    var permissions = req.permissions;\n    if (!permissions) return res.status(401).send(\"Not authorized, permissions empty\" +permissions);\n    if (!permissionsAllowed) return next();\n\n    if (Array.isArray(permissionsAllowed)) {\n      var found = permissions.some(function (r) {\n        return permissionsAllowed.includes(r);\n      });\n      if (!found) return res.status(401).send(\"Permission missing\");\n    }\n    else if (typeof permissionsAllowed === 'string' || permissionsAllowed instanceof String) {\n      if (permissions.indexOf(permissionsAllowed) === -1) return res.status(401).send(\"Permission missing\");\n    }\n\n    return next();\n  };\n};"]},"metadata":{},"sourceType":"script"}